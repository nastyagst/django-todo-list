{% extends 'todo/base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>TODO list</h1>
  <a href="{% url 'task-create' %}" class="btn btn-primary">Add task</a>
</div>

{% for task in tasks %}
<div class="mb-4 pb-3 border-bottom">
  <div class="d-flex justify-content-between">
    <div>
      <span style="font-size: 1.2rem; font-weight: bold;">{{ task.content }}</span>
      {% if task.is_done %}
      <span class="text-success fw-bold">Done</span>
      {% else %}
      <span class="text-danger fw-bold">Not done</span>
      {% endif %}

      <div class="text-muted small mt-1">
        Created: {{ task.created_datetime|date:"F j, Y, g:i a" }}

        {% if task.deadline %}
        <span class="text-danger ms-2">
          Deadline: {{ task.deadline|date:"F j, Y, g:i a" }}
        </span>
        {% endif %}
      </div>

      <div class="mt-1">
        <span class="text-muted">Tags:</span>
        {% for tag in task.tags.all %}
        {{ tag.name }}{% if not forloop.last %}, {% endif %}
        {% empty %}
        No tags
        {% endfor %}

        <a href="{% url 'task-update' task.id %}" class="text-decoration-none ms-2">Update</a>
        <a href="{% url 'task-delete' task.id %}" class="text-decoration-none ms-2">Delete</a>
      </div>
    </div>

    <div>
      <form action="{% url 'task-toggle-status' task.id %}" method="post">
        {% csrf_token %}
        {% if task.is_done %}
        <button type="submit" class="btn btn-secondary">Undo</button>
        {% else %}
        <button type="submit" class="btn btn-success">Complete</button>
        {% endif %}
      </form>
    </div>
  </div>
</div>
{% empty %}
<p>No tasks yet.</p>
{% endfor %}
{% endblock %}